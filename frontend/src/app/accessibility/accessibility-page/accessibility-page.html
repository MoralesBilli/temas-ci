<section class="max-w-3xl mx-auto px-4 py-8">
  <div class="card bg-base-100 shadow-lg">
    <div class="card-body space-y-8">
      <header class="space-y-2">
        <p class="text-sm uppercase tracking-wide text-base-content/60">Preferencias visuales</p>
        <h1 class="card-title" [attr.id]="headingId">Accesibilidad</h1>
        <p class="text-base-content/70">
          Ajusta el contraste, el tamaño de fuente y el tipo de letra para que la experiencia se adapte a tus necesidades.
        </p>
      </header>

      <article class="space-y-4" aria-labelledby="theme-section">
        <div>
          <p id="theme-section" class="font-semibold">Tema visual</p>
          <p class="text-base-content/70">
            Elige la combinación de colores que mejor se adapte a tu vista, incluidos modos para daltonismo y luz nocturna.
          </p>
        </div>
        <div class="theme-radio-group join join-vertical md:join-horizontal">
          @for (option of availableThemes; track option.value) {
            <label class="btn btn-outline theme-radio join-item flex flex-col items-start gap-1"
                   [class.btn-active]="selectedTheme() === option.value"
                   [attr.aria-pressed]="selectedTheme() === option.value">
              <input
                type="radio"
                name="theme-selector"
                class="theme-controller sr-only"
                [value]="option.value"
                [checked]="selectedTheme() === option.value"
                (change)="onThemeSelect(option.value)"
                [attr.aria-label]="option.label"
              />
              <span class="text-sm font-semibold">{{ option.label }}</span>
              <span class="text-xs text-base-content/70">{{ option.description }}</span>
            </label>
          }
        </div>
      </article>

      <article class="space-y-4" aria-labelledby="font-size-section">
        <div class="flex items-start justify-between gap-4 flex-wrap">
          <div>
            <p id="font-size-section" class="font-semibold">Tamaño general de letra</p>
            <p class="text-base-content/70">{{ fontScalePercent() }}% del tamaño base.</p>
          </div>
          <span class="badge badge-outline">{{ fontScalePercent() }}%</span>
        </div>
        <label class="form-control gap-2" aria-label="Desliza para ajustar el tamaño de letra">
          <input
            type="range"
            class="range range-primary w-full"
            [attr.min]="fontScaleMin"
            [attr.max]="fontScaleMax"
            [attr.step]="fontScaleStep"
            [ngModel]="accessibility.fontScale()"
            (ngModelChange)="accessibility.setFontScale($event)"
            aria-describedby="font-size-section"
          />
          <div class="flex w-full justify-between text-xs px-1">
            <span>{{ (fontScaleMin * 100) | number:'1.0-0' }}%</span>
            <span>{{ (fontScaleMax * 100) | number:'1.0-0' }}%</span>
          </div>
        </label>
      </article>

      <article class="space-y-3" aria-labelledby="dyslexia-section">
        <div class="flex items-center justify-between gap-4 flex-wrap">
          <div>
            <p id="dyslexia-section" class="font-semibold">Tipografía para dislexia</p>
            <p class="text-base-content/70">Cambia a una fuente con trazos reforzados para mejorar la lectura.</p>
          </div>
          <label class="label cursor-pointer gap-3">
            <span class="label-text">{{ accessibility.dyslexicFont() ? 'Activada' : 'Desactivada' }}</span>
            <input
              type="checkbox"
              role="switch"
              class="toggle toggle-primary"
              [checked]="accessibility.dyslexicFont()"
              (change)="onDyslexicToggle($event)"
              aria-describedby="dyslexia-section"
            />
          </label>
        </div>
      </article>

      <article class="space-y-3" aria-labelledby="cursor-section">
        <div class="flex items-center justify-between gap-4 flex-wrap">
          <div>
            <p id="cursor-section" class="font-semibold">Cursor de alto contraste</p>
            <p class="text-base-content/70">
              Amplía el puntero del mouse y lo convierte en un triángulo de alto contraste visible en cualquier vista.
            </p>
          </div>
          <label class="label cursor-pointer gap-3">
            <span class="label-text">{{ largeCursorEnabled() ? 'Activado' : 'Desactivado' }}</span>
            <input
              type="checkbox"
              role="switch"
              class="toggle toggle-accent"
              [checked]="largeCursorEnabled()"
              (change)="onLargeCursorToggle($event)"
              aria-describedby="cursor-section cursor-hint"
            />
          </label>
        </div>
        <p id="cursor-hint" class="text-sm text-base-content/70">
          El cursor resaltado mantiene el modo texto en campos de entrada, pero mejora la visibilidad en botones, enlaces y menús.
        </p>
      </article>

      <article class="space-y-3" aria-labelledby="voice-reader-section">
        <div class="flex items-center justify-between gap-4 flex-wrap">
          <div>
            <p id="voice-reader-section" class="font-semibold">Modo lector de voz</p>
            <p class="text-base-content/70">
              Lee en voz alta el contenido textual sobre el que pasas el cursor y recuerda el último fragmento para evitar reinicios.
            </p>
          </div>
          <label class="label cursor-pointer gap-3">
            <span class="label-text">
              {{ voiceReaderSupported ? (voiceReaderEnabled() ? 'Activado' : 'Desactivado') : 'No disponible' }}
            </span>
            <input
              type="checkbox"
              role="switch"
              class="toggle toggle-info"
              [checked]="voiceReaderEnabled()"
              [disabled]="!voiceReaderSupported"
              (change)="onVoiceReaderToggle($event)"
              aria-describedby="voice-reader-section voice-reader-hint"
            />
          </label>
        </div>
        <p id="voice-reader-hint" class="text-sm text-base-content/70">
          {{ voiceReaderSupported
            ? 'El lector se detiene solo cuando cambias a otro texto y mantiene el último fragmento narrado en memoria.'
            : 'Tu navegador no expone la API de voz necesaria para activar esta función.'
          }}
        </p>
      </article>

      <article class="space-y-3" aria-labelledby="ai-navigation-section">
        <div class="flex items-center justify-between gap-4 flex-wrap">
          <div>
            <p id="ai-navigation-section" class="font-semibold">Navegación asistida por IA</p>
            <p class="text-base-content/70">
              Activa un copiloto gestual que interpreta tus movimientos frente a la cámara con Teachable Machine.
            </p>
          </div>
          <label class="label cursor-pointer gap-3">
            <span class="label-text">
              {{ aiNavigationSupported ? (aiNavigationEnabled() ? 'Activado' : 'Desactivado') : 'No disponible' }}
            </span>
            <input
              type="checkbox"
              role="switch"
              class="toggle toggle-secondary"
              [checked]="aiNavigationEnabled()"
              [disabled]="!aiNavigationSupported"
              (change)="onAiNavigationToggle($event)"
              aria-describedby="ai-navigation-section ai-navigation-hint"
            />
          </label>
        </div>
        <p id="ai-navigation-hint" class="text-sm text-base-content/70">
          {{ aiNavigationSupported
            ? 'Se mostrará una microcámara en la esquina superior izquierda. Tus gestos (front, up, down, right, left) se registrarán y se mostrarán en la consola.'
            : 'Tu navegador no permite acceder a la cámara o la API necesaria para este modo.'
          }}
        </p>
      </article>
    </div>
  </div>
</section>
